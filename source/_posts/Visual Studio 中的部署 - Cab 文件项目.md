title: Visual Studio 中的部署 - Cab 文件项目
date: 2014-11-18 17:32:39
tags: .cab
---
##Cab 文件项目
---
(http://technet.microsoft.com/zh-cn/windows/fwb783c5)
使用 Cab 项目，可以创建 `.Cab` 文件，以便对可以从 Web 服务器下载到 Web 浏览器的 ActiveX 控件进行打包。
与其他部署项目类型不同，没有提供处理 CAB 项目的编辑器。文件和项目输出可以添加到“解决方案资源管理器”的 Cab 项目中，属性可以在“属性”窗口或“项目属性”页中设置。
CAB 项目的属性允许您指定压缩级别、实现 Authenticode 签名、设置显示名称和版本信息，以及指定依赖文件在 Web 上的位置。

##创建或添加 Cab 项目
---
(http://technet.microsoft.com/zh-cn/magazine/aa291420(VS.71).aspx)

Cab 项目用于创建压缩 (.cab) 文件，这些文件用于将组件下载到 Web 浏览器中。如果希望代码在客户端计算机而不是服务器上运行时，应使用此选项。

###创建新的 Cab 项目

 1. 在“文件”菜单上指向“添加项目”，然后单击“新建项目”。
 2. 在产生的“添加新项目”对话框中，选择“安装和部署项目”文件夹。 
 3. 选择“Cab 项目”。

###向解决方案中添加现有的 cab 项目

 1. 在“文件”菜单上指向“添加项目”，然后单击“现有项目”。
 2. 在产生的“添加现有项目”对话框中，浏览到 Cab 项目所在的位置后单击“打开”。

##演练：创建 Cab 文件
---
以下演练演示为 ActiveX 控件创建 CAB 文件，并将其部署到 Web 站点以便可以下载到最终用户的浏览器中。
###为 ActiveX 控件创建 Cab 项目

 1. 在“文件”菜单上指向“新建”，然后选择“项目”。
 2. 在“新建项目”对话框中，选择“项目类型”窗格中的“安装和部署项目”，然后选择“模板”窗格中的“Cab 项目”。在“名称”框中键入 AXControl。
 3. 单击“确定”关闭对话框。
 4. 在解决方案资源管理器中，选择“AXControl”项目。在“项目”菜单上，选择“添加”->“文件”。
 5. 在“添加文件”对话框中，浏览并找到 ActiveX 控件 (.ocx)，然后单击“确定”关闭对话框。
 6. 在“项目”菜单上，选择“属性”。
 7. 在“项目属性”对话框中，选中“Authenticode 签名”复选框，并输入“证书文件”、“私钥文件”和“时间戳服务器”。单击“确定”关闭对话框。
 8. 在“生成”菜单上，选择“生成 AXControl”。

###创建 Web 应用程序

 1. 在“文件”菜单上，选择“添加项目”->“新建项目”。
 2. 在“添加新项目”对话框中，选择“项目类型”窗格中的“Visual Basic 项目”，然后选择“模板”窗格中的“ASP.NET Web 应用程序”。在“位置”框中，键入 http://localhost/AXControlWeb。
 3. 单击“确定”关闭对话框。
 4. 选择“工具箱”窗口。在“工具”菜单上选择“添加/移除工具箱项”。
 5. 在“自定义工具箱”对话框中，选择在前一过程中使用的同一个 ActiveX 控件。
 6. 单击“确定”关闭对话框。
 7. 在“工具箱”窗口中，选择 ActiveX 控件并将其拖到“Webform1.aspx”设计器中。
 8. 在“项目”菜单上，选择“添加现有项”。
 9. 在“添加现有项”对话框中，定位到项目目录并查找生成的 Cab 文件。默认路径将是 \documents and settings\yourloginname\AXControl\project configuration\AXControl.Cab。默认“项目配置”是“调试”。单击“确定”关闭对话框。
 10. 在“Webform1.aspx”设计器中选择 ActiveX 控件。
 11. 在“属性”窗口中，选择 codebase 属性并单击“省略号”（）按钮。
 12. 在“创建 URL”对话框中，从“目录”窗格中选择“AXControl.Cab”，然后单击“确定”关闭对话框。
 13. 在“生成”菜单上，选择“生成解决方案”。

###测试安装
浏览至未注册 ActiveX 控件的计算机的 Web 页 (http://computername/AXControlWeb/Webform1.aspx)。请确认控件已安装在该计算机上且“Authenticode”对话框已显示。
  